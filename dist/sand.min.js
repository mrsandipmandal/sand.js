!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).SandJS={})}(this,function(t){"use strict";function e(t){const n=new Map,o=[];const r={get(t,r){if("__isProxy"===r)return!0;!function(t){const e=o[o.length-1];if(!e)return;let r=n.get(t);r||(r=new Set,n.set(t,r)),r.add(e)}(r);const s=Reflect.get(t,r);return s&&"object"==typeof s?e(s).proxy:s},set(t,e,o){const r=t[e],s=Reflect.set(t,e,o);return r!==o&&function(t){const e=n.get(t);e&&e.forEach(t=>t())}(e),s}};return{proxy:new Proxy(Object.assign({},t||{}),r),effect:function(t){const e=function(){try{o.push(e),t()}finally{o.pop()}};return e(),e}}}function n(t,e={}){if(!t)return;const n=Object.keys(e||{}),o=Object.values(e||{});try{return new Function(...n,"with(this) { return ("+t+"); }").apply(e,o)}catch(e){return void console.warn("[sandi-js] safeEval error for expression:",t,e)}}function o(t,e){const o=t.getAttribute("s-init");o&&(t._s_inited||(t._s_inited=!0,n(o,e)))}function r(t,e){const o=t.getAttribute("s-text");t.textContent=n(o,e)??""}function s(t,e){const o=n(t.getAttribute("s-html"),e);t.innerHTML=null==o?"":o}function c(t,e){const o=t.getAttribute("s-effect");o&&e&&"function"==typeof e.__effect&&(t._s_effect_registered||(e.__effect(()=>{try{n(o,e)}catch(t){console.warn("[sandi-js] s-effect error",t)}}),t._s_effect_registered=!0))}function i(t,e){const n=t.getAttribute("s-ref");n&&e&&(e.$refs=e.$refs||{},e.$refs[n]=t)}function a(t){t&&t.hasAttribute&&t.hasAttribute("s-cloak")&&t.removeAttribute("s-cloak")}function f(t,e){const n=t.getAttribute("s-model");if(n){try{const o=function(t,e){if(e)return-1===e.indexOf(".")?t[e]:e.split(".").reduce((t,e)=>null==t?void 0:t[e],t)}(e,n);void 0!==o&&t.value!==String(o)&&(t.value=o)}catch(t){}t._s_model_bound||(t.addEventListener("input",()=>{try{!function(t,e,n){if(!e)return;if(-1===e.indexOf("."))return void(t[e]=n);const o=e.split(".");let r=t;for(let t=0;t<o.length-1;t++){const e=o[t];null==r[e]&&(r[e]={}),r=r[e]}r[o[o.length-1]]=n}(e,n,t.value)}catch(t){console.warn("[sandi-js] s-model set error",t)}}),t._s_model_bound=!0)}}function l(t,e){const n=t.getAttribute("s-modelable");n&&(e.$modelable[n]=t)}function u(t,e){let o;t._s_if_placeholder||(t._s_if_placeholder=document.createComment("s-if"));try{o=n(t.getAttribute("s-if"),e)}catch(t){o=!1}if(o){const e=t._s_if_placeholder;e&&e.parentNode&&!t.isConnected&&e.parentNode.replaceChild(t,e)}else if(t.isConnected){const e=t._s_if_placeholder;t.parentNode&&t.parentNode.replaceChild(e,t)}else!t._s_if_placeholder.parentNode&&t.parentNode&&t.parentNode.insertBefore(t._s_if_placeholder,t)}function d(t,e){const o=n(t.getAttribute("s-show"),e);t.style.display=o?"":"none"}function h(t,e){const o=t.getAttribute("s-bind");if(!o)return;o.split(",").map(t=>t.trim()).filter(Boolean).forEach(o=>{const r=o.split(":");if(r.length<2)return;const s=r.shift().trim(),c=n(r.join(":").trim(),e);try{t[s]=c}catch{t.setAttribute(s,c)}})}function p(){}function y(t,e,o){if(!o)return;let r;if(o.startsWith("@"))r=o.slice(1);else{if(!o.startsWith("s-on:"))return;r=o.slice(5)}const s=t.getAttribute(o);if(!s)return;const c=`_s_on_${r}`;t[c]||(t.addEventListener(r,t=>{try{n(s,Object.assign(Object.create(e),{$event:t}))}catch(t){console.warn("[sandi-js] s-on handler error",t)}}),t[c]=!0)}function _(t){const e=t.getAttribute("s-transition")||"all 150ms ease";t.style.transition=e}function b(t){const e=t.getAttribute("s-teleport");if(!e)return;t._s_teleport_placeholder||(t._s_teleport_placeholder=document.createComment("s-teleport"));const n=document.querySelector(e);n&&(t._s_teleported||(t.parentNode&&!t._s_teleport_placeholder.parentNode&&t.parentNode.insertBefore(t._s_teleport_placeholder,t),n.appendChild(t),t._s_teleported=!0))}let m=0;function g(t){const e=t.getAttribute("s-id")||"s-id";t.id||(t.id=`${e}-${++m}`)}const j=["s-","x-"];function A(t,e){for(const n of j)if(t.hasAttribute(n+e))return!0;return!1}function w(t,e){for(const n of j){const o=t.getAttribute(n+e);if(null!=o)return o}return null}const v=function(){let t=[],e=!1;function n(){try{const e=t.slice();t=[];for(let t=0;t<e.length;t++)try{e[t]()}catch(t){console.error("[sandi-js] job error:",t)}}finally{e=!1}}return{schedule:function(o){"function"==typeof o&&(t.push(o),e||(e=!0,Promise.resolve().then(n).catch(n=>{e=!1,t=[],console.error("[sandi-js] Scheduler error:",n)})))}}}();function x(t=document.body){if(!t||"function"!=typeof t.querySelectorAll)return;const m=j.map(t=>`[${t}data]`).join(",");t.querySelectorAll(m).forEach(t=>{const m=e(n(w(t,"data")||"{}",{})||{}),x=m.proxy;x.$refs=x.$refs||{},x.$modelable=x.$modelable||{},x.__effect=t=>m.effect(t);const k=w(t,"init");if(k)try{n(k,x)}catch(t){console.warn("[sandi-js] s-init error",t)}m.effect(()=>{Object.keys(m.proxy).forEach(t=>{try{x[t]=m.proxy[t]}catch(t){}}),v.schedule(()=>function(t,e){if(!t)return;$(t,t=>{if(1!==t.nodeType)return;try{if(A(t,"ignore"))return!0}catch(t){}if(A(t,"ref"))try{i&&i(t,e)}catch(t){console.warn("[sandi-js] s-ref",t)}if(A(t,"id"))try{g&&g(t)}catch(t){console.warn("[sandi-js] s-id",t)}if(A(t,"cloak"))try{a&&a(t)}catch(t){}if(A(t,"text"))try{r&&r(t,e)}catch(t){console.warn("[sandi-js] s-text",t)}if(A(t,"html"))try{s&&s(t,e)}catch(t){console.warn("[sandi-js] s-html",t)}if(A(t,"show"))try{d&&d(t,e)}catch(t){console.warn("[sandi-js] s-show",t)}if(A(t,"bind"))try{h&&h(t,e)}catch(t){console.warn("[sandi-js] s-bind",t)}if(A(t,"if")){try{u&&u(t,e)}catch(t){console.warn("[sandi-js] s-if",t)}if(!t.isConnected)return!0}if(A(t,"for")&&p&&!t.isConnected)return!0;if(A(t,"model"))try{f&&f(t,e)}catch(t){console.warn("[sandi-js] s-model",t)}if(A(t,"modelable"))try{l&&l(t,e)}catch(t){console.warn("[sandi-js] s-modelable",t)}if(A(t,"effect"))try{c&&c(t,e)}catch(t){console.warn("[sandi-js] s-effect",t)}if(A(t,"teleport")){try{b&&b(t)}catch(t){console.warn("[sandi-js] s-teleport",t)}if(!t.isConnected)return!0}if(A(t,"transition"))try{_&&_(t)}catch(t){console.warn("[sandi-js] s-transition",t)}if(A(t,"init"))try{o&&o(t,e)}catch(t){console.warn("[sandi-js] s-init (nested)",t)}const n=t.attributes||[];for(let o=0;o<n.length;o++){const r=n[o];if(!r)continue;const s=r.name;if(s.startsWith("@")||s.startsWith("s-on:")||s.startsWith("x-on:"))try{y&&y(t,e,s)}catch(t){console.warn("[sandi-js] s-on",t)}}})}(t,x))}),function(t,e){for(const n of j)t.removeAttribute(n+e)}(t,"data"),t.querySelectorAll("[s-cloak],[x-cloak]").forEach(t=>t.removeAttribute("s-cloak")),t.hasAttribute("s-cloak")&&t.removeAttribute("s-cloak"),t.hasAttribute("x-cloak")&&t.removeAttribute("x-cloak")})}function $(t,e){if(!0===e(t))return;const n=Array.from(t.childNodes||[]);for(let t=0;t<n.length;t++){const o=n[t];if(1===o.nodeType)$(o,e);else try{e(o)}catch(t){}}}"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>x()):x());var k={mount:x,createReactive:e};t.createReactive=e,t.default=k,t.mount=x,Object.defineProperty(t,"__esModule",{value:!0})});
